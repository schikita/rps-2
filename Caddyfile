rps-game.ru {
    # Matcher for backend services including WebSockets
    @backend {
        path /api*
        path /auth*
        path /health*
        path /socket.io*
    }
    
    handle @backend {
        reverse_proxy backend:3000
    }
    
    # Default handling for everything else (frontend)
    handle {
        reverse_proxy cyber-rps:80
    }

    log {
        output file /var/log/caddy/access.log
    }
}

:80 {
    reverse_proxy cyber-rps:80
}
